{"version":3,"sources":["webpack://@block-cat/guest-gamification/webpack/bootstrap","webpack://@block-cat/guest-gamification/external \"flarum.core.compat['common/extend']\"","webpack://@block-cat/guest-gamification/external \"flarum.core.compat['common/components/Button']\"","webpack://@block-cat/guest-gamification/external \"flarum.core.compat['common/utils/classList']\"","webpack://@block-cat/guest-gamification/external \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@block-cat/guest-gamification/external \"flarum.core.compat['common/utils/abbreviateNumber']\"","webpack://@block-cat/guest-gamification/external \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@block-cat/guest-gamification/external \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@block-cat/guest-gamification/./src/forum/helpers/saveVote.js","webpack://@block-cat/guest-gamification/./src/forum/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","post","upvoted","downvoted","load","discussion","canVote","redraw","save","then","pushAttributes","votes","app","initializers","add","extensions","setting","helpers","firstPost","undefined","extend","CommentPost","items","has","this","attrs","hasDownvoted","hasUpvoted","icon","upVotesOnly","canSeeVotes","onclick","saveVote","val","voteLoading","replace","className","classList","Button","component","loading","disabled","translator","trans","DiscussionListItem","view","seeVotes","children","content","find","v","includes","upvotesOnly","altIcon","shift","unshift","data-upvotes-only","data-active","aria-label","class","abbreviateNumber","display","size","session","user"],"mappings":"2BACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QA0Df,OArDAF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,G,gBClFrDhC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,kB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,6B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,2B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,iC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,kC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,uC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,wC,gGCArB,WAACC,EAAMC,EAASC,EAAWC,EAAMC,GAE9C,QAFiF,IAAnCA,MAAaJ,EAAKI,eAE5DA,GAAeA,EAAWC,WAAcL,EAAKK,UAajD,OATIJ,GAAWC,IACbD,GAAU,EACVC,GAAY,GAGVC,GAAMA,GAAK,GAEflC,EAAEqC,SAEKN,EACJO,KAAK,CAACN,EAASC,EAAW,SAC1BM,MACC,kBAAM,QACN,kBAAM,QAEPA,MAAK,WACAL,GAAMA,GAAK,GAEXC,GACFA,EAAWK,eAAe,CACxBC,MAAOV,EAAKU,UAIhBzC,EAAEqC,a,gDCrBRK,IAAIC,aAAaC,IAAI,gCAAgC,WAEnD,GAAKhB,OAAOiB,WAAW,oBAAvB,CAoBA,IACEC,EACElB,OAAOiB,WAAW,oBAAoBE,QADxCD,QAGIrC,EAAM,SAAC0B,EAAYhB,GACvB,IAAMY,EAAOI,EAAWa,YAExB,OAAIjB,QAAwBkB,IAAhBlB,EAAKZ,KACRY,EAAKZ,KAGPgB,EAAWhB,MAIpB+B,iBAAOC,IAAY3B,UAAW,eAAe,SAAU4B,GAAO,WAC5D,GAAIA,EAAMC,IAAI,SAAU,CAEtB,IAAMtB,EAAOuB,KAAKC,MAAMxB,KAElByB,EAAezB,EAAKyB,eACpBC,EAAa1B,EAAK0B,aAElBC,EAAOZ,EAAQ,aAAe,SAC9Ba,EAAcb,EAAQ,eAAe,GAErCc,EAAc7B,EAAK6B,cAGnBxB,EAAUL,EAAKK,UAGfyB,EAAU,SAAC7B,EAASC,GAAV,OAAwB6B,EAAS/B,EAAMC,EAASC,GAAW,SAAC8B,GAAD,OAAU,EAAKC,YAAcD,MAIxGX,EAAMa,QACJ,QACA,SAAKC,UAAWC,IAAU,oBAAqBrB,EAAQ,sBAAsB,IAAS,oBACnFsB,IAAOC,UAAU,CAChBX,KAAMJ,KAAKU,iBAAcf,EAAnB,gBAA+CS,EAA/C,MACNQ,UAAWC,IAAU,wBAAyBV,GAAc,qBAC5Da,QAAShB,KAAKU,YACdO,SAAUjB,KAAKU,cAAgB5B,IAAYwB,EAC3CC,QAAS,kBAAMA,GAASJ,GAAY,IACpC,aAAcf,IAAI8B,WAAWC,MAAM,+CAGrC,WAAOP,UAAU,eAAenC,EAAKU,UAEnCkB,GACAS,IAAOC,UAAU,CACfX,KAAMJ,KAAKU,iBAAcf,EAAnB,gBAA+CS,EAA/C,QACNQ,UAAWC,IAAU,0BAA2BX,GAAgB,qBAChEc,QAAShB,KAAKU,YACdO,UAAWnC,IAAYwB,EACvBC,QAAS,kBAAMA,GAAQ,GAAQL,IAC/B,aAAcd,IAAI8B,WAAWC,MAAM,kDAGzC,QAMF3B,EAAQ,sBAAsB,IAChCI,iBAAOwB,IAAmBlD,UAAW,QAAQ,SAAUmD,GAAM,WACrDxC,EAAamB,KAAKC,MAAMpB,WAE9B,GAAKA,EAAWyC,YAIXD,GAASA,EAAKE,SAAnB,CAEA,IAAMC,EAAUH,EAAKE,SAASE,MAAK,SAACC,GAAD,OAAOA,GAAKA,EAAEzB,OAASyB,EAAEzB,MAAMW,WAAac,EAAEzB,MAAMW,UAAUe,SAAS,iCACpGlD,EAAOI,EAAWa,YAElBS,EAAahD,EAAI0B,EAAY,cAC7BqB,EAAe/C,EAAI0B,EAAY,gBAE/BC,EAAU3B,EAAI0B,EAAY,WAE1B+C,EAAcpC,EAAQ,eAAe,GACrCqC,EAAUrC,EAAQ,gBAAkB,QAEpCe,EAAU,SAAC7B,EAASC,GAAV,OAAwB6B,EAAS/B,EAAMC,EAASC,GAAW,SAAC8B,GAAD,OAAU,EAAKC,YAAcD,MAGxGe,EAAQD,SAASO,QACjBN,EAAQD,SAASQ,QACf,SAAKnB,UAAU,2CAA2CoB,oBAAmBJ,GAC3E,EAAC,IAAD,CACEhB,UAAU,mGACVR,KAAI,gBAAkByB,EAAlB,MACJI,cAAa9B,EACbc,UAAWnC,GAAWkB,KAAKU,YAC3BH,QAAS,kBAAMA,GAASJ,GAAY,IACpC+B,aAAY9C,IAAI8B,WAAWC,MAAM,+CAGnC,UAAMgB,MAAM,gCAAgCC,IAAiBjF,EAAI0B,EAAY,UAAY,KAEvF+C,GACA,EAAC,IAAD,CACEhB,UAAU,qGACVR,KAAI,gBAAkByB,EAAlB,QACJI,cAAa/B,EACbe,UAAWnC,GAAWkB,KAAKU,YAC3BH,QAAS,kBAAMA,GAAQ,GAAQL,IAC/BgC,aAAY9C,IAAI8B,WAAWC,MAAM,iDAIpCnB,KAAKU,aAAe,EAAC,IAAD,CAAkB2B,QAAQ,SAASC,KAAK,gBAOjE9C,EAAQ,mBAAmB,IAC7BI,iBAAOC,IAAY3B,UAAW,eAAe,SAAU4B,GAAO,WAC5D,GAAIA,EAAMC,IAAI,SAAU,CACtB,IAAMtB,EAAOuB,KAAKC,MAAMxB,KAExB,IAAKA,EAAK6B,cAAe,OAEzB,IAAMJ,EAAezB,EAAKyB,eACpBC,EAAa1B,EAAK0B,aAElBC,EAAOZ,EAAQ,aAAe,SAC9BoC,EAAcpC,EAAQ,eAAe,GAErCc,EAAc7B,EAAK6B,cAGnBxB,GAAWM,IAAImD,QAAQC,MAAQ/D,EAAKK,UAEpCyB,EAAU,SAAC7B,EAASC,GAAV,OACd6B,EAAS/B,EAAMC,EAASC,GAAW,SAAC8B,GAClC,EAAKC,YAAcD,MAGvBX,EAAMa,QACJ,QACA,SAAKC,UAAU,6BAA6BoB,oBAAmBJ,GAC7D,EAAC,IAAD,CACEhB,UAAU,uEACVR,KAAI,gBAAkBA,EAAlB,MACJ6B,cAAa9B,EACbc,UAAWnC,GAAWkB,KAAKU,cAAgBJ,EAC3CC,QAAS,kBAAMA,GAASJ,GAAY,IACpC+B,aAAY9C,IAAI8B,WAAWC,MAAM,+CAGnC,UAAMgB,MAAM,kBAAkBC,IAAiB3D,EAAKU,SAAW,KAE7DyC,GACA,EAAC,IAAD,CACEhB,UAAU,yEACVR,KAAI,gBAAkBA,EAAlB,QACJ6B,cAAa/B,EACbe,UAAWnC,GAAWkB,KAAKU,YAC3BH,QAAS,kBAAMA,GAAQ,GAAQL,IAC/BgC,aAAY9C,IAAI8B,WAAWC,MAAM,iDAIpCnB,KAAKU,aAAe,EAAC,IAAD,CAAkB2B,QAAQ,SAASC,KAAK,WAE/D","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['forum/components/CommentPost'];","module.exports = flarum.core.compat['common/utils/abbreviateNumber'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['forum/components/DiscussionListItem'];","export default (post, upvoted, downvoted, load, discussion = post.discussion()) => {\r\n  // BkC deleted 'if(!app.session.user)' condition from here\r\n  if (discussion && !discussion.canVote() && !post.canVote()) {\r\n    return;\r\n  }\r\n\r\n  if (upvoted && downvoted) {\r\n    upvoted = false;\r\n    downvoted = false;\r\n  }\r\n\r\n  if (load) load(true);\r\n\r\n  m.redraw();\r\n\r\n  return post\r\n    .save([upvoted, downvoted, 'vote'])\r\n    .then(\r\n      () => null,\r\n      () => null\r\n    )\r\n    .then(() => {\r\n      if (load) load(false);\r\n\r\n      if (discussion) {\r\n        discussion.pushAttributes({\r\n          votes: post.votes(),\r\n        });\r\n      }\r\n\r\n      m.redraw();\r\n    });\r\n};","import { extend } from 'flarum/common/extend';\r\nimport CommentPost from 'flarum/forum/components/CommentPost';\r\nimport Button from 'flarum/common/components/Button';\r\nimport classList from 'flarum/common/utils/classList';\r\nimport saveVote from './helpers/saveVote';\r\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\r\nimport abbreviateNumber from 'flarum/common/utils/abbreviateNumber';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\n\r\napp.initializers.add('block-cat/guest-gamification', () => {\r\n  // exit if 'fof-gamification' isn't active\r\n  if (!flarum.extensions['fof-gamification']) return;\r\n\r\n  // extend(CommentPost.prototype, 'oncreate', function (vnode) {\r\n  //   const post = this.attrs.post;\r\n      \r\n  //   const hasDownvoted = post.hasDownvoted();\r\n  //   const hasUpvoted = post.hasUpvoted();\r\n\r\n  //   // saveVote was created in './helpers/saveVote' and modified by BkC\r\n  //   const onclick = (upvoted, downvoted) => saveVote(post, upvoted, downvoted, (val) => (this.voteLoading = val));\r\n\r\n  //   let upvotes = $(\"button.Post-vote.Post-upvote\");\r\n    \r\n  //   upvotes.map((index, upvote) => {\r\n  //     upvote.onclick = () => onclick(!hasUpvoted, false) && console.log(\"Some\");\r\n  //   });\r\n  //   console.log($(\"button.Post-vote.Post-upvote\"));\r\n  // });\r\n\r\n  // import 'setting' function from 'fof-gamification.helpers'\r\n  const {\r\n    setting\r\n  } = flarum.extensions['fof-gamification'].helpers;\r\n\r\n  const get = (discussion, key) => {\r\n    const post = discussion.firstPost();\r\n  \r\n    if (post && post[key]() !== undefined) {\r\n      return post[key]();\r\n    }\r\n  \r\n    return discussion[key]();\r\n  };\r\n\r\n  // change onclick function on comment post\r\n  extend(CommentPost.prototype, 'actionItems', function (items) {\r\n    if (items.has('votes')) {\r\n      // same code from 'fof-gamification'\r\n      const post = this.attrs.post;\r\n      \r\n      const hasDownvoted = post.hasDownvoted();\r\n      const hasUpvoted = post.hasUpvoted();\r\n      \r\n      const icon = setting('iconName') || 'thumbs';\r\n      const upVotesOnly = setting('upVotesOnly', true);\r\n      \r\n      const canSeeVotes = post.canSeeVotes();\r\n      \r\n      // We set canVote to true for guest users so that they can access the login by clicking the button\r\n      const canVote = post.canVote(); // modified by BkC\r\n      \r\n      // saveVote was created in './helpers/saveVote' and modified by BkC\r\n      const onclick = (upvoted, downvoted) => saveVote(post, upvoted, downvoted, (val) => (this.voteLoading = val));\r\n      \r\n      // replace with same component but\r\n      // onclick call another 'saveVote' function\r\n      items.replace(\r\n        'votes',\r\n        <div className={classList('CommentPost-votes', setting('useAlternateLayout', true) && 'alternateLayout')}>\r\n          {Button.component({\r\n            icon: this.voteLoading ? undefined : `fas fa-fw fa-${icon}-up`,\r\n            className: classList('Post-vote Post-upvote', hasUpvoted && 'Post-vote--active'),\r\n            loading: this.voteLoading,\r\n            disabled: this.voteLoading || !canVote || !canSeeVotes,\r\n            onclick: () => onclick(!hasUpvoted, false),\r\n            'aria-label': app.translator.trans('fof-gamification.forum.post.upvote_button'),\r\n          })}\r\n\r\n          <label className=\"Post-points\">{post.votes()}</label>\r\n\r\n          {!upVotesOnly &&\r\n            Button.component({\r\n              icon: this.voteLoading ? undefined : `fas fa-fw fa-${icon}-down`,\r\n              className: classList('Post-vote Post-downvote', hasDownvoted && 'Post-vote--active'),\r\n              loading: this.voteLoading,\r\n              disabled: !canVote || !canSeeVotes,\r\n              onclick: () => onclick(false, !hasDownvoted),\r\n              'aria-label': app.translator.trans('fof-gamification.forum.post.downvote_button'),\r\n            })}\r\n        </div>,\r\n        10\r\n      );\r\n    }\r\n  });\r\n\r\n  // change onclick function on DiscussionListItem\r\n  if (setting('useAlternateLayout', true)) {\r\n    extend(DiscussionListItem.prototype, 'view', function (view) {\r\n      const discussion = this.attrs.discussion;\r\n\r\n      if (!discussion.seeVotes()) {\r\n        return;\r\n      }\r\n\r\n      if (!view || !view.children) return;\r\n\r\n      const content = view.children.find((v) => v && v.attrs && v.attrs.className && v.attrs.className.includes('DiscussionListItem-content'));\r\n      const post = discussion.firstPost();\r\n\r\n      const hasUpvoted = get(discussion, 'hasUpvoted');\r\n      const hasDownvoted = get(discussion, 'hasDownvoted');\r\n      // We set canVote to true for guest users so that they can access the login by clicking the button\r\n      const canVote = get(discussion, 'canVote');\r\n\r\n      const upvotesOnly = setting('upVotesOnly', true);\r\n      const altIcon = setting('iconNameAlt') || 'arrow';\r\n\r\n      const onclick = (upvoted, downvoted) => saveVote(post, upvoted, downvoted, (val) => (this.voteLoading = val));\r\n\r\n      // delete 'fof-gamification' version\r\n      content.children.shift();\r\n      content.children.unshift(\r\n        <div className=\"DiscussionListItem-votes alternateLayout\" data-upvotes-only={upvotesOnly}>\r\n          <Button\r\n            className=\"DiscussionListItem-voteButton DiscussionListItem-voteButton--up Button Button--icon Button--text\"\r\n            icon={`fas fa-fw fa-${altIcon}-up`}\r\n            data-active={hasUpvoted}\r\n            disabled={!canVote || this.voteLoading}\r\n            onclick={() => onclick(!hasUpvoted, false)}\r\n            aria-label={app.translator.trans('fof-gamification.forum.post.upvote_button')}\r\n          />\r\n  \r\n          <span class=\"DiscussionListItem-voteCount\">{abbreviateNumber(get(discussion, 'votes') || 0)}</span>\r\n  \r\n          {!upvotesOnly && (\r\n            <Button\r\n              className=\"DiscussionListItem-voteButton DiscussionListItem-voteButton--down Button Button--icon Button--text\"\r\n              icon={`fas fa-fw fa-${altIcon}-down`}\r\n              data-active={hasDownvoted}\r\n              disabled={!canVote || this.voteLoading}\r\n              onclick={() => onclick(false, !hasDownvoted)}\r\n              aria-label={app.translator.trans('fof-gamification.forum.post.downvote_button')}\r\n            />\r\n          )}\r\n  \r\n          {this.voteLoading && <LoadingIndicator display=\"inline\" size=\"small\" />}\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  // change onclick function on CommentPost, alternative layout\r\n  if (setting('altPostVotingUi', true)) {\r\n    extend(CommentPost.prototype, 'headerItems', function (items) {\r\n      if (items.has('votes')) {\r\n        const post = this.attrs.post;\r\n\r\n        if (!post.canSeeVotes()) return;\r\n\r\n        const hasDownvoted = post.hasDownvoted();\r\n        const hasUpvoted = post.hasUpvoted();\r\n\r\n        const icon = setting('iconName') || 'thumbs';\r\n        const upvotesOnly = setting('upVotesOnly', true);\r\n\r\n        const canSeeVotes = post.canSeeVotes();\r\n\r\n        // We set canVote to true for guest users so that they can access the login by clicking the button\r\n        const canVote = !app.session.user || post.canVote();\r\n\r\n        const onclick = (upvoted, downvoted) =>\r\n          saveVote(post, upvoted, downvoted, (val) => {\r\n            this.voteLoading = val;\r\n          });\r\n        \r\n        items.replace(\r\n          'votes',\r\n          <div className=\"Post-votes alternateLayout\" data-upvotes-only={upvotesOnly}>\r\n            <Button\r\n              className=\"Post-voteButton Post-voteButton--up Button Button--icon Button--text\"\r\n              icon={`fas fa-fw fa-${icon}-up`}\r\n              data-active={hasUpvoted}\r\n              disabled={!canVote || this.voteLoading || !canSeeVotes}\r\n              onclick={() => onclick(!hasUpvoted, false)}\r\n              aria-label={app.translator.trans('fof-gamification.forum.post.upvote_button')}\r\n            />\r\n    \r\n            <span class=\"Post-voteCount\">{abbreviateNumber(post.votes() || 0)}</span>\r\n    \r\n            {!upvotesOnly && (\r\n              <Button\r\n                className=\"Post-voteButton Post-voteButton--down Button Button--icon Button--text\"\r\n                icon={`fas fa-fw fa-${icon}-down`}\r\n                data-active={hasDownvoted}\r\n                disabled={!canVote || this.voteLoading}\r\n                onclick={() => onclick(false, !hasDownvoted)}\r\n                aria-label={app.translator.trans('fof-gamification.forum.post.downvote_button')}\r\n              />\r\n            )}\r\n    \r\n            {this.voteLoading && <LoadingIndicator display=\"inline\" size=\"small\" />}\r\n          </div>,\r\n          10000\r\n        );\r\n      }\r\n    });\r\n  };\r\n\r\n});\r\n"],"sourceRoot":""}